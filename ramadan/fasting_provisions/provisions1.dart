import 'package:flutter/material.dart';
import '../../utilities/utilities.dart';

String p1 =
    'إذا لم تثبت رؤية هلال رمضان في التاسع والعشرين من شعبان، فإننا نكمل شعبان ثلاثين يوماً، سواء كانت السماء مصحية أو مغيمة - قول عامة أهل العلم أنظر المغني.';
String p2 =
    'من رأى هلال رمضان وحده ولم يشهد برؤيته أو شهد ولم تقبل شهادته فإنه يصوم مع الناس إذا صاموا ولا يبني على رؤيته -ابن باز ، خلافآ للمذاهب الفقهية الحنفية والمالكية والشافعية والحنابلة والظاهرية.';
String p3 = 'يكفي في ثبوت دخول رمضان شهادة عدلٍ واحد - ابن باز وابن عثيمين.';
String p4 = 'يُشترَطُ في الرائي مع عدالته، قوةُ بصره  - ابن عثيمين.';
String p5 =
    'من رأى هلال رمضان وحده وهو في مكانٍ ناءٍ ليس فيه أحد، فإنه يصوم، ويبني على رؤيته ولا يرد عليه الخلاف السابق - ابن باز وابن عثيمين.';
String p6 =
    'إذا رأى أهل بلدٍ الهلال فإنه لا يجب الصوم على الجميع مع اختلاف المطالع، وإنما يجب على من رآه أو كان في حكمهم بأن توافقت مطالع الهلال - ابن عثيمين.';
String p7 =
    'لا يجوز الاعتماد على الأقمار الصناعية في رؤية الهلال وذلك لأن الأقمار الصناعية تكون مرتفعةً عن الأرض التي هي محل ترائي الهلال - ابن عثيمين.';
String p8 =
    'يجوز استعمال المراصد الفلكية لرؤية الهلال كالدربيل وهو المنظار المقرِّب، ولكنه ليس بواجب فلو رأى الهلال عبرها من يُوثَقُ به فإنه يُعمل بهذه الرؤية - ابن باز وابن عثيمين.';
String p9 =
    'من عمي عليه خبر الهلال والشهور كالسجين والأسير بدار الحرب وغيرهما، فإنه يجتهد ويتحرى الهلال ويصوم شهراً  - المذاهب الفقهية الأربعة وحكي إجماع السلف على ذلك، و إن صام مجتهداً بما غلب على ظنه، فله أربع حالات: أولا: أن يتبين له أن صومه وافق شهر رمضان، فصومه صحيح، ولا إعادة عليه ، ثانيا: أن يستمر الإشكال عليه، فلا يعلم هل وافق الشهر أو تقدمه أو تأخره، فيجزئه ولا إعادة عليه ، ثالثا: أن يتيبن له أن صومه كان قبل رمضان، فعليه الإعادة - قول أكثر الفقهاء أنظر المغني ، رابعا: أن يتبين له أنه صام بعد نهاية شهر رمضان، فهذا يجزئه، ولا إعادة عليه إلا فيما لا يصح صيامه كالعيدين ، فإن عليه أن يعيد الأيام التي لا يصح صيامها - قول عامة الفقهاء أنظر المغني.';
String p10 =
    'إن صام الأسير ونحوه من غير اجتهاد، فلا يصح صومه، وعليه الإعادة، حتى وإن تبين له أن صومه وافق رمضان - الشافعية.';
String p11 =
    'لا يجوز العمل بالحساب الفلكي ولا الاعتماد عليه في إثبات دخول رمضان - بالإجماع.';
String p12 =
    'يجب صوم رمضان بأحد أمرين : أولا: برؤية هلاله ، ثانيا: إتمام شعبان ثلاثين يوماً لأن الشهر الهلالي لا يمكن أن يزيد عن ثلاثين يوماً ، ولا يمكن أن ينقص عن تسعة وعشرين يوماً - ابن عثيمين.';
String p13 =
    'إن حال دون رؤية الهلال غيم أو قتر -أي التراب الذي يأتي مع الرياح- ليلة الثلاثين من شعبان فما العمل؟ الراجح أنه يحرم صيام ذلك اليوم ، ولكن إذا ثبت عند الإمام وجوب صوم ذلك اليوم وأمر الناس بصيامه فإنه لا ينابذ ، ويحصل عدم منابذته بألا يظهر الإنسان فطره ذلك اليوم ، وإنما يفطر سراً ، والأقليات الإسلامية في الدول الكافرة إن كان هناك رابطة أو مكتب أو مركز إسلامي فإنها تعمل بقولهم وإذا لم يكن كذلك فإنها تخير والأحسن أن تتبع أقرب بلد إليها، لو تراءى عدل الهلال مع جماعة كثيرين وهو قوي البصر ولم يره غيره فهل يصام برؤيته ؟ نعم يصام، ومن رأى الهلال وهو ممن يفعل الكبيرة كشرب الخمر يلزمه أن يخبر أنه رأى الهلال، ولا يخبر أنه يفعل كبيرة لأن الأحكام تتبعّض - ابن عثيمين.';
String p14 =
    'لا يجوز لأحدٍ صوم يوم الثلاثين من شعبان -وهو المسمى بيوم الشك على خلاف بين العلماء في تحديد معنى يوم الشك- احتياطاً لرمضان، إلا إن وافق صوماً كان يصومه -المالكية والشافعية ورواية عن أحمد.';
String p15 =
    'يشرع ترائي الهلال في اليوم التاسع والعشرين ليلة الثلاثين ومن أهل العلم من يعبر باستحباب ذلك ومنهم من يعبر بأنه فرض كفاية - انظر المغني وفتح القدير لإبن الهمام.';
String p16 =
    'من رأى هلال شوال لوحده فإنه لا يفطر حتى يفطر الناس - ابن باز وابن عثيمين.';
String p17 =
    'إذا لم يَرَ هلال شوال شاهدان عدلان، وجب إكمال شهر رمضان ثلاثين يوماً  - بالإجماع .';
String p18 =
    'يثبت دخول شهر شوال وغيره من الشهور بشهادة شاهدين ، وإذا صام الناس بشهادة واحد ثلاثين يومآ فلم يرى الهلال فالصحيح يلزمهم الفطر، ولو صام برؤية بلد ثم سافر لبلد آخر قد صاموا بعدهم بيوم وأتم هو ثلاثين يومًا ولم ير الهلال في تلك البلد التي سافر إليها، فالصحيح أنه يصوم معهم ولو صام واحد وثلاثين يومآ - ابن عثيمين.';

class Provision1 extends StatefulWidget {
  const Provision1({super.key});

  @override
  State<Provision1> createState() => _Provision1State();
}

class _Provision1State extends State<Provision1> {
  final PreferencesManager _preferencesManager = PreferencesManager();

  @override
  void initState() {
    super.initState();

    _loadPreferences();
  }

  Future<void> _loadPreferences() async {
    await _preferencesManager.loadTheme();
    await _preferencesManager.loadFontSize();
    setState(() {});
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: PreferredSize(
        preferredSize: const Size.fromHeight(40.0),
        child: AppBar(
          leading: BackButton(
            color: const Color(0xFFFFFFFF),
            onPressed: () {
              Navigator.pop(context);
            },
          ),
          title: const Padding(
            padding: EdgeInsets.only(top: 6),
            child: Text(
              'الرؤية والأتمام',
              style: TextStyle(
                fontSize: 16.0,
                fontFamily: 'swissr',
                fontWeight: FontWeight.bold,
                color: Colors.white,
              ),
            ),
          ),
          centerTitle: true,
          flexibleSpace: Container(
            decoration: const BoxDecoration(
              gradient: LinearGradient(
                colors: [
                  Color(0xFF353535),
                  Color(0xFF353535),
                  Color(0xFF353535)
                ],
                begin: Alignment.topCenter,
                end: Alignment.bottomCenter,
              ),
            ),
          ),
          foregroundColor: const Color(0xFFFFFFFF),
          actions: [
            IconButton(
              onPressed: () {},
              icon: Image.asset(
                'assets/images/ramadan/telescope.png',
                height: 25.0,
                width: 25.0,
              ),
            )
          ],
        ),
      ),
      body: NotificationListener<ScrollNotification>(
        child: Stack(children: [
          ScrollbarTheme(
            data: ScrollbarThemeData(
              interactive: true,
              thumbColor: MaterialStateProperty.all<Color>(
                _preferencesManager.isDarkMode
                    ? const Color(0xACBBBBBB)
                    : const Color(0x3CBBBBBB),
              ),
              radius: const Radius.circular(2),
              thickness: MaterialStateProperty.all<double>(7),
            ),
            child: Scrollbar(
              thumbVisibility: true,
              child: Container(
                height: MediaQuery.of(context).size.height,
                padding: const EdgeInsets.symmetric(horizontal: 20),
                color: _preferencesManager.isDarkMode
                    ? const Color(0xFFECECEC)
                    : const Color(0xFF1B1B1B),
                child: SingleChildScrollView(
                  child: Directionality(
                    textDirection: TextDirection.rtl,
                    child: Column(
                      children: [
                        const SizedBox(height: 20),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p1,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p2,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p3,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p4,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p5,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p6,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p7,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p8,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p9,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p10,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p11,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p12,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p13,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p14,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p15,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p16,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p17,
                        ),
                        PrevisionText(
                          preferencesManager: _preferencesManager,
                          content: p18,
                        ),
                        const SizedBox(height: 40),
                      ],
                    ),
                  ),
                ),
              ),
            ),
          )
        ]),
      ),
    );
  }
}

class PrevisionText extends StatelessWidget {
  const PrevisionText({
    super.key,
    required PreferencesManager preferencesManager,
    required this.content,
  }) : _preferencesManager = preferencesManager;

  final String content;
  final PreferencesManager _preferencesManager;

  @override
  Widget build(BuildContext context) {
    return Container(
      padding: const EdgeInsets.only(
        top: 10,
        bottom: 0,
        right: 5,
        left: 5,
      ),
      margin: const EdgeInsets.only(bottom: 10),
      decoration: BoxDecoration(
        borderRadius: const BorderRadius.all(Radius.circular(15)),
        color: _preferencesManager.isDarkMode
            ? Colors.white
            : colorParagraphContentDark,
      ),
      child: paragraphContent(content,
          isDarkMode: _preferencesManager.isDarkMode,
          fontSize: _preferencesManager.fontSize),
    );
  }
}
